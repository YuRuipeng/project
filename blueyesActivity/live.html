 <!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link rel="stylesheet" type="text/css" href="live-css/public.css"/>
		<link rel="stylesheet" type="text/css" href="live-css/video-js.css"/>
		<link rel="stylesheet" type="text/css" href="live-css/mescroll.css"/>
		<link rel="stylesheet" type="text/css" href="live-css/zoomify.min.css"/>
		<link rel="stylesheet" type="text/css" href="live-css/video-live.css"/>
		<link rel="stylesheet" type="text/css" href="live-css/css.css"/>
	</head>
	<body>
		<div class="video-top-top">
			<div class="video-live-videobox">
				<video id="example-video" webkit-playsinline="true" x-webkit-airplay="true"  playsinline="true" x5-video-player-type="h5" x5-video-player-fullscreen="false" autoplay="autoplay" class="video-js vjs-default-skin" controls="controls" poster="img/video-im.png">
				  <source
				     src="http://21442.mpull.live.lecloud.com/live/111/desc.m3u8"
				     type="application/x-mpegURL">
				</video>
			</div>
			
			<div class="video-live-nav">
				<ul>
					<li class="active">直播间</li>
					<li>评论</li>
					<li>更多直播</li>
				</ul>
			</div>
		</div>	
		<div class="live-body">
			<div class="live-body-info">
				<div class="liveC-info-logo">
                    <img src="image/icon_logo.png" alt="">
                </div>
                <div class="liveC-info-content">
                    <p class="liveC-info-content-name">记者谭立强</p>
                    <p class="liveC-info-content-text">记者谭立强记者谭立强记者谭立强记者谭立强记者谭立强记者谭立强记者谭立强记者谭立强记者谭立强记者谭立强记者谭立强记者谭立强记者谭立强记者谭立强记者谭立强记者谭立强记者谭立强记者谭立强记者谭立强</p>
                </div>
			</div>
            <div class="live-body-talk">
				<div class="talk-box">
					<div class="swiper-container1">
				        <div class="swiper-wrapper">
				            <div class="swiper-slide">
				            	<div class="talk-box-main">
				            		<img src="img/img7.png">
				                	<dl>
				                		<dt>梅洛斯之路</dt>
				                		<dd><p>还挺高清的</p></dd>
				                	</dl>
				                	<p class="talk-timer">2017-09-07  11:08</p>
				            	</div>
				            	<div class="talk-box-main">
				            		<img src="img/img9.png">
				                	<dl>
				                		<dt>@#%#</dt>
				                		<dd><p>最近正好想买这个牛排啊！</p></dd>
				                	</dl>
				                	<p class="talk-timer">2017-09-07  11:08</p>
				            	</div>
				            	<div class="talk-box-main">
				            		<img src="img/img8.png">
				                	<dl>
				                		<dt>向日葵</dt>
				                		<dd><div class="talk-box-imgbox"><img src="img/video-im.png"/></div></dd>
				                	</dl>
				                	<p class="talk-timer">2017-09-07  11:08</p>
				            	</div>
				            	<div class="talk-box-main1">
				            		<img src="img/img8.png">
				                	<dl>
				                		<dt>向日葵</dt>
				                		<dd><div class="talk-box-imgbox"><a class="example2" href="https://ss2.baidu.com/6ONYsjip0QIZ8tyhnq/it/u=1925862410,3009948017&fm=173&s=E2ABB14772D0DF9EAB1110B003007030&w=218&h=146&img.JPEG"><img src="img/video-im.png"/></a></div></dd>
				                	</dl>
				                	<p class="talk-timer">2017-09-07  11:08</p>
				            	</div>
				            </div>
				        </div>
				    </div>
				</div>
				<img class="zan" src="image/icon_dianzan.png"/>
				<img class="piao" src="image/icon_paihang.png"/>
				<img class="redpacketimg" src="image/icon_liwu.png"/>
			</div>
			<div class="live-body-list mescroll" id="mescroll" data-type=1>
				<ul id="newsList" class="news-list">
					<li class="news-content">
                        <a href="#">
                            <div class="new-content-matter">
                                <div class="new-conten-matter-img">
                                    <img src="image/news_small.png" alt="">
                                </div>
                                <p class="new-content-matter-text">青岛包揽第四届帆船比赛前五名</p>
                                <p class="new-content-matter-time">07:54</p>
                            </div>
                        </a>
                    </li>
				</ul>
			</div>
		</div>
		
		<div class="enter-box">
			<div class="enter-box-top">
				<textarea id="text" name="" rows="" cols="" placeholder="说点什么..."></textarea>
				<img src="img/更多.png" class="enter-box-more"/>
				<img src="img/img12.png" class="enter-box-enter"/>
			</div>
			<div class="enter-box-bottom">
				<dl>
					<dt><img src="img/img14.png"/></dt>
					<dd>表情</dd>
				</dl>
				<dl>
					<dt>
						<img src="img/图片.png"/>
						<input type="file" id="file1" multiple="" accept="image/png,image/gif,image/jpg,image/jpeg" name="file" />
					</dt>
					<dd>图片</dd>
				</dl>
			</div>
		</div>
		<script src="live-js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="live-js/jquery.imgbox.pack.js" type="text/javascript" charset="utf-8"></script>
		<script src="https://cdn.bootcss.com/Swiper/4.0.6/js/swiper.min.js"></script>
		<script src="live-js/wx-emj-fix.js" type="text/javascript" charset="utf-8"></script>
		<script src="live-js/video.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="live-js/videojs-contrib-hls.js" type="text/javascript" charset="utf-8"></script>
		<script src="live-js/mescroll.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" charset="utf-8">
		
		
		

		//直播视频
		var player = videojs('example-video');
		player.play();
		
			//轮播
			var swiper = new Swiper('.demoh', {
		        pagination: '.swiper-pagination',
				autoplay: 1000,
				loop : true,
				observer:true,//修改swiper自己或子元素时，自动初始化swiper  
				observeParents:true,//修改swiper的父元素时，自动初始化swiper 
		    });
			

		    //点击切换导航
		    $(".video-live-nav").find("li").click(function(){
		    	$(".video-live-nav").find("li").removeClass("active")
		    	$(this).addClass("active")
		    	if($(".video-live-nav").find("li").eq(0).hasClass("active")){
		    		$(".live-body-talk").hide();
		    		$(".live-body-info").show();
		    		$(".live-body-list").hide();
		    		$(".enter-box").hide();
		    	}else if($(".video-live-nav").find("li").eq(1).hasClass("active")){
		    		$(".live-body-talk").show();
		    		$(".live-body-info").hide();
		    		$(".live-body-list").hide();
		    		$(".enter-box").show();
		    	}
		    	else if($(".video-live-nav").find("li").eq(2).hasClass("active")){
		    		$(".live-body-talk").hide();
		    		$(".live-body-info").hide();
		    		$(".live-body-list").show();
		    		$(".enter-box").hide();
		    	}
		    	
		    	
		    	
		    	document.getElementById("text").wxImeEmojiFix(); // 原生用法
		    	
		    	
		    	
		    	
		    	//往期回看上啦加载下拉刷新 
		    	
		    	if($(".live-body-list").css("display")=="block"&&$(".live-body-list").attr("data-type")==1){
		    	$(".live-body-list").attr("data-type","2")
		    	 var mescroll = new MeScroll("mescroll", {
			up: {
				page:{size:2},//每次加载1条数据,模拟loadFull
				loadFull: {
					use: true, //列表数据过少,不足以滑动触发上拉加载,是否自动加载下一页,直到满屏或者无更多数据为止;默认false,因为可通过调高page.size避免这个情况
					delay: 500 //延时执行的毫秒数; 延时是为了保证列表数据或占位的图片都已初始化完成,且下拉刷新上拉加载中区域动画已执行完毕;
				},
				clearEmptyId: "dataList", //1.下拉刷新时会自动先清空此列表,再加入数据; 2.无任何数据时会在此列表自动提示空
				callback: getListData //上拉回调,此处可简写; 相当于 callback: function (page) { getListData(page); }
			}
		});
		
		function getListData(page){
//			page.num++;
			console.log("page.num=="+page.num);
			getListDataFromNet(page.num, page.size, function(data){
				console.log(data.length);
				mescroll.endSuccess(data.length);
				setListdom(data);
			}, function(){
				 mescroll.endErr();
			})
		}
		function setListdom(data){
			console.log(JSON.stringify(data));
			var oul = document.getElementsByClassName('news-list')[0];
			for(var i = 0; i < data.length; i++){
			    var str = '<div class="live-body-list-left"><img src="img/img-index.png" alt="" /></div>'
					+'<div class="live-body-list-right">'
					+'<h2>915吃在青岛没事评选</h2>'
					+'<p class="live-body-list-right-info">假期上演出身争霸</p>'
					+'<div class="live-body-list-right-footer">'
					+'<p><i class="iconfont icon-people"></i><span>63763</span>人次</p> <p><span>2017-9-20</span><i>14：19</i></p>'
					+'</div></div>';
					
			    var liDom=document.createElement("li");
			    liDom.className = 'mui-table-view-cell mui-media';
				liDom.innerHTML=str;
				oul.appendChild(liDom);
			}
			
		}
		function getListDataFromNet(pageNum, pageSize, successCB, errorCB){
			setTimeout(function(){
				$.ajax({
					type:"get",
					url:"http://test.hisunflower.com/mobile/index.php?act=service_goods&op=goods_list",
					async:true,
					dataType: 'json',
					data:{
						gc_id: '53',
						curpage: pageNum,
						page: pageSize
					},
					success: function(data){
						var listData = [];
						console.log(data);
						if(data.datas.goods_list != ''){
							for(var i = 0; i < data.datas.goods_list.length; i++){
								console.log((i+1) == data.datas.goods_list.length);
								if(!data.hasmore) break;
								listData.push(data.datas.goods_list[i]);
							}
							
						}
						successCB(listData);
					},
					error: errorCB
				});
			},500)
		}
		    }
		   })
		   
		    //点击发送消息的js
		    $(".enter-box-enter").onclick=function(){
				var time2 = new Date().Format("yyyy-MM-dd HH:mm");
				
				$(".talk-box").find(".swiper-slide").append("<div class='talk-box-main1'><img src='img/img8.png'><dl><dt>向日葵</dt><dd><p>"+$(".enter-box").find("textarea").val()+"</p></dd></dl><p class='talk-timer'>"+time2+"</p></div>")
				
			$(".enter-box").find("textarea").val("")
			scroll(0, 100000);
			}
		   Date.prototype.Format = function (fmt) { //author: meizz   
			    var o = {  
			        "M+": this.getMonth() + 1, //月份   
			        "d+": this.getDate(), //日   
			        "H+": this.getHours(), //小时   
			        "m+": this.getMinutes(), //分   
			        "s+": this.getSeconds(), //秒   
			        "q+": Math.floor((this.getMonth() + 3) / 3), //季度   
			        "S": this.getMilliseconds() //毫秒   
			    };  
			    if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));  
			    for (var k in o)  
			    if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));  
			    return fmt;  
			}
		    
		    
		    //点赞特效
		    
		    
		    $(".zan").click(function(){  
		        var x = 100;         
		        var y = 900;    
		        var num = Math.floor(Math.random() * 5 + 1);  
		        var index=$('.live-body-talk').children('.heart').length;  
		        var rand = parseInt(Math.random() * (x - y + 1) + y);   
		          
		        $(".live-body-talk").append("<img class='heart' src=''>");
		        $('.heart').eq(index).attr('src','img/'+num+'.png')  
		  
		  
		        $(".heart").animate({  
		            bottom:"300",  
		            opacity:"0",  
		            left: rand,  
		        },3000)  
		          
		   });
		    
		    
		   
		    //点击更多
		    $(".enter-box-more").onclick=function(){
		    	if($(".enter-box-bottom").css("display")=="block"){
			   		$(".enter-box-bottom").css("display","none")
			   	}else{
			   		$(".enter-box-bottom").css("display","block")
			   	}
		    }
		   	$(".example2").imgbox({
				'speedIn'		: 0,
				'speedOut'		: 0,
				'alignment'		: 'center',
				'overlayShow'	: true,
				'allowMultiple'	: false
			});
		</script>
	</body>
</html>
